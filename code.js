(()=>{"use strict";let e={cssUnits:"px",classNamingStrategy:"layer-based",attributeCasing:"kebab-case",layoutPreference:"flexbox",svgExportMode:"inline"};function t(e,t){return function(e){let t=0,s="",i=!1;for(let n=0;n<e.length;n++){const o=e[n];"<"===o&&"/"!==e[n+1]?(n>0&&(s+="\n"+"  ".repeat(t)),t++,i=!0):"<"===o&&"/"===e[n+1]?(t--,">"!==e[n-1]&&(s+="\n"+"  ".repeat(t)),i=!0):">"===o&&i&&(i=!1),s+=o}return s}(new i(t).processNodeForHtml(e).html)}function s(e,t){return new i(t).processNodeForCss(e).css.replace(/\{/g," {\n  ").replace(/;/g,";\n  ").replace(/\}/g,"\n}\n").replace(/\n  \n/g,"\n").trim()}figma.ui.onmessage=t=>{"update-config"===t.type&&(e=Object.assign(Object.assign({},e),t.config),figma.clientStorage.setAsync("plugin-config",e)),"get-config"===t.type&&figma.ui.postMessage({type:"config",config:e})},function(){var i,n,o,r;i=this,n=void 0,r=function*(){const i=yield figma.clientStorage.getAsync("plugin-config");i&&(e=Object.assign(Object.assign({},e),i)),figma.codegen.on("generate",(i=>{const{language:n,node:o}=i;if(!o)return[{language:"PLAINTEXT",code:"// No node selected",title:"Error"}];switch(n){case"HTML":return[{language:"HTML",code:t(o,e),title:"HTML"}];case"CSS":return[{language:"CSS",code:s(o,e),title:"CSS"}];default:return[{language:"PLAINTEXT",code:"// Language not supported: "+n,title:"Unsupported"}]}}))},new((o=void 0)||(o=Promise))((function(e,t){function s(e){try{c(r.next(e))}catch(e){t(e)}}function a(e){try{c(r.throw(e))}catch(e){t(e)}}function c(t){var i;t.done?e(t.value):(i=t.value,i instanceof o?i:new o((function(e){e(i)}))).then(s,a)}c((r=r.apply(i,n||[])).next())}))}();class i{constructor(e){this.uniqueIdCounter=0,this.config=e,this.cssRules=new Map}processNodeForHtml(e){if("visible"in e&&!e.visible)return{html:"",classNames:[]};const t=this.generateClassName(e),s=[t];let i="",n="div",o={};const r=this.getSemanticClass(e);switch(r&&s.push(r),e.type){case"TEXT":n=this.determineTextTag(e),i=this.escapeHtml(e.characters),this.processFontStyles(e,t);break;case"VECTOR":case"STAR":case"ELLIPSE":case"POLYGON":case"LINE":"inline"===this.config.svgExportMode&&(i="\x3c!-- SVG content would be exported here --\x3e",n="span",o["aria-hidden"]="true");break;case"FRAME":case"GROUP":case"COMPONENT":case"COMPONENT_SET":case"INSTANCE":if(n=this.determineContainerTag(e),"layoutMode"in e?this.processAutoLayout(e,t):this.processPosition(e,t),"children"in e){const t=[];for(const s of e.children){const e=this.processNodeForHtml(s);e.html&&t.push(e.html)}i=t.join("\n")}break;case"RECTANGLE":if(n=this.determineRectangleTag(e),"fills"in e&&e.fills&&Array.isArray(e.fills)){const t=e.fills.find((e=>"IMAGE"===e.type&&!1!==e.visible));t&&"IMAGE"===t.type&&(n="img",o.src="placeholder.jpg",o.alt=e.name||"Image",o.loading="lazy","width"in e&&"height"in e&&(o.width=String(Math.round(e.width)),o.height=String(Math.round(e.height))))}this.processBasicStyles(e,t);break;default:n="div",this.processBasicStyles(e,t)}let a="";s.length>0&&(o.class=s.join(" "));const c=Object.entries(o).map((([e,t])=>`${e}="${t}"`)).join(" ");return"img"===n?a=`<img ${c} />`:(a=`<${n}${c?" "+c:""}>`,i&&(a+=i),a+=`</${n}>`),{html:a,classNames:s}}determineTextTag(e){const t=e.name.toLowerCase().includes("heading")||e.name.toLowerCase().includes("title")||e.name.toLowerCase().includes("h1")||e.name.toLowerCase().includes("h2"),s=e.fontSize!==figma.mixed&&e.fontSize>=20,i=e.fontName!==figma.mixed&&e.fontName.style.toLowerCase().includes("bold"),n=e.characters.length<30;return t&&s?e.fontSize!==figma.mixed&&e.fontSize>=32?"h1":e.fontSize!==figma.mixed&&e.fontSize>=24?"h2":"h3":n&&!i?"span":"p"}determineContainerTag(e){const t=e.name.toLowerCase();return t.includes("header")||t.includes("nav")?"header":t.includes("footer")?"footer":t.includes("main")||t.includes("content")?"main":t.includes("section")||t.includes("container")?"section":t.includes("article")||t.includes("card")?"article":t.includes("aside")||t.includes("sidebar")?"aside":t.includes("nav")||t.includes("menu")?"nav":"div"}determineRectangleTag(e){const t=e.name.toLowerCase();return t.includes("button")||t.includes("btn")?"button":t.includes("card")||t.includes("item")?"article":"div"}getSemanticClass(e){const t=e.name.toLowerCase();return t.includes("button")||t.includes("btn")?"button":t.includes("card")?"card":t.includes("icon")?"icon":t.includes("input")?"input":t.includes("header")?"header":t.includes("footer")?"footer":t.includes("nav")?"nav":null}processNodeForCss(e){const{classNames:t}=this.processNodeForHtml(e),s=this.extractCssVariables();let i="";if(s.size>0){i+=":root {\n";for(const[e,t]of s.entries())i+=`  ${e}: ${t};\n`;i+="}\n\n"}i+="* {\n  box-sizing: border-box;\n  margin: 0;\n  padding: 0;\n}\n\n",i+=".container {\n  width: 100%;\n  max-width: 1200px;\n  margin: 0 auto;\n  padding: 0 15px;\n}\n\n",i+="/* Mobile First Media Queries */\n",i+="@media (min-width: 768px) {\n  /* Tablet styles */\n}\n\n",i+="@media (min-width: 992px) {\n  /* Desktop styles */\n}\n\n";for(const[e,t]of this.cssRules.entries()){i+=`${e} {\n`;for(const[e,s]of t.entries()){const t=this.getVariableNameForValue(e,s);i+=t?`  ${e}: var(${t});\n`:`  ${e}: ${s};\n`}i+="}\n\n"}return{css:i,classNames:t}}extractCssVariables(){const e=new Map,t=new Map;for(const[,e]of this.cssRules.entries())for(const[s,i]of e.entries())if(this.isVariableCandidateProperty(s)){const e=`${s}:${i}`,n=t.get(e)||{count:0,property:s};n.count++,t.set(e,n)}for(const[s,{count:i,property:n}]of t.entries())if(i>=2){const t=s.split(":")[1],i=this.createVariableName(n,t);e.set(i,t)}return e.has("--color-text")||e.set("--color-text","#333"),e.has("--color-bg")||e.set("--color-bg","#fff"),e.has("--font-main")||e.set("--font-main","'Inter', -apple-system, BlinkMacSystemFont, sans-serif"),e}isVariableCandidateProperty(e){return e.startsWith("color")||e.startsWith("background-color")||e.startsWith("font-")||"border-radius"===e||e.includes("shadow")}createVariableName(e,t){let s="--";return"color"===e||"background-color"===e?t.includes("rgb(0, 0, 0)")||t.includes("#000")?s+="color-black":t.includes("rgb(255, 255, 255)")||t.includes("#fff")?s+="color-white":s+="color"===e?"color-text":"color-primary":e.startsWith("font-")?s+=`font-${e.split("-")[1]}`:"border-radius"===e?s+="radius":e.includes("shadow")?s+="shadow":s+=e.replace(/([A-Z])/g,"-$1").toLowerCase(),s}getVariableNameForValue(e,t){return"color"===e&&t.includes("rgb(0, 0, 0)")?"--color-text":"background-color"===e&&t.includes("rgb(255, 255, 255)")?"--color-bg":"font-family"===e?"--font-main":null}processBasicStyles(e,t){const s=`.${t}`,i=new Map;if(this.cssRules.has(s)){const e=this.cssRules.get(s);if(e)for(const[t,s]of e.entries())i.set(t,s)}else this.cssRules.set(s,i);if("width"in e&&"height"in e&&(i.set("width",this.convertToUnits(e.width)),i.set("height",this.convertToUnits(e.height))),"cornerRadius"in e&&0!==e.cornerRadius&&e.cornerRadius!==figma.mixed){const t=e.cornerRadius;i.set("border-radius",this.convertToUnits(t))}if("fills"in e&&e.fills&&Array.isArray(e.fills)){const t="TEXT"===e.type;this.processFills(e.fills,i,t)}"strokes"in e&&e.strokes&&Array.isArray(e.strokes)&&this.processStrokes(e,i),"effects"in e&&e.effects&&Array.isArray(e.effects)&&this.processEffects(e.effects,i),this.cssRules.set(s,i)}processFills(e,t,s=!1){const i=e.filter((e=>!1!==e.visible));if(0===i.length)return;if(1===i.length&&"SOLID"===i[0].type){const e=i[0],n=this.rgbaToCSS(e.color.r,e.color.g,e.color.b,e.opacity||1);return void(s?t.set("color",n):t.set("background-color",n))}const n=i.filter((e=>"IMAGE"===e.type));if(n.length>0&&!s){t.set("background-image",'url("placeholder.jpg")');const e=n[0];"FILL"===e.scaleMode?t.set("background-size","cover"):"FIT"===e.scaleMode&&t.set("background-size","contain")}else if(!s){const e=i.filter((e=>"GRADIENT_LINEAR"===e.type||"GRADIENT_RADIAL"===e.type||"GRADIENT_ANGULAR"===e.type));if(e.length>0){const s=e[0];if("GRADIENT_LINEAR"===s.type){const e=this.linearGradientToCSS(s);t.set("background-image",e)}else if("GRADIENT_RADIAL"===s.type){const e=this.radialGradientToCSS(s);t.set("background-image",e)}}}}processStrokes(e,t){var s;if(!Array.isArray(e.strokes)||!e.strokes.length)return;const i=e.strokes.filter((e=>!1!==e.visible));if(0===i.length)return;const n=i[0];if("SOLID"===n.type){const i=this.rgbaToCSS(n.color.r,n.color.g,n.color.b,n.opacity||1),o=e.strokeWeight!==figma.mixed&&null!==(s=e.strokeWeight)&&void 0!==s?s:1;if(t.set("border-style","solid"),t.set("border-width",this.convertToUnits(o)),t.set("border-color",i),e.strokeAlign!==figma.mixed)switch(e.strokeAlign){case"INSIDE":t.set("box-sizing","border-box");break;case"OUTSIDE":t.set("outline",`${this.convertToUnits(o)} solid ${i}`),t.set("outline-offset",this.convertToUnits(o))}}}processEffects(e,t){const s=e.filter((e=>!1!==e.visible));if(0===s.length)return;const i=s.filter((e=>"DROP_SHADOW"===e.type||"INNER_SHADOW"===e.type));if(i.length>0){const e=i.map((e=>{const{color:t,offset:s,radius:i,spread:n,type:o}=e,r=this.rgbaToCSS(t.r,t.g,t.b,t.a);return`${this.convertToUnits(s.x)} ${this.convertToUnits(s.y)} ${this.convertToUnits(i)} ${this.convertToUnits(null!=n?n:0)} ${r}${"INNER_SHADOW"===o?" inset":""}`})).join(", ");t.set("box-shadow",e)}const n=s.filter((e=>"LAYER_BLUR"===e.type||"BACKGROUND_BLUR"===e.type));n.length>0&&n.forEach((e=>{"LAYER_BLUR"===e.type?t.set("filter",`blur(${this.convertToUnits(e.radius)})`):"BACKGROUND_BLUR"===e.type&&t.set("backdrop-filter",`blur(${this.convertToUnits(e.radius)})`)}))}processAutoLayout(e,t){const s=`.${t}`;let i=this.cssRules.get(s);i||(i=new Map,this.cssRules.set(s,i)),i.set("display","flex"),"HORIZONTAL"===e.layoutMode?i.set("flex-direction","row"):"VERTICAL"===e.layoutMode&&i.set("flex-direction","column"),"MIN"===e.primaryAxisAlignItems?i.set("justify-content","flex-start"):"CENTER"===e.primaryAxisAlignItems?i.set("justify-content","center"):"MAX"===e.primaryAxisAlignItems?i.set("justify-content","flex-end"):"SPACE_BETWEEN"===e.primaryAxisAlignItems&&i.set("justify-content","space-between"),"MIN"===e.counterAxisAlignItems?i.set("align-items","flex-start"):"CENTER"===e.counterAxisAlignItems?i.set("align-items","center"):"MAX"===e.counterAxisAlignItems&&i.set("align-items","flex-end"),0!==e.paddingLeft&&i.set("padding-left",this.convertToUnits(e.paddingLeft)),0!==e.paddingRight&&i.set("padding-right",this.convertToUnits(e.paddingRight)),0!==e.paddingTop&&i.set("padding-top",this.convertToUnits(e.paddingTop)),0!==e.paddingBottom&&i.set("padding-bottom",this.convertToUnits(e.paddingBottom)),0!==e.itemSpacing&&i.set("gap",this.convertToUnits(e.itemSpacing)),"WRAP"===e.layoutWrap&&i.set("flex-wrap","wrap")}processPosition(e,t){if(!("x"in e)||!("y"in e))return;const s=`.${t}`;let i=this.cssRules.get(s);i||(i=new Map,this.cssRules.set(s,i)),"allow-absolute"===this.config.layoutPreference&&(i.set("position","absolute"),i.set("left",this.convertToUnits(e.x)),i.set("top",this.convertToUnits(e.y)))}processFontStyles(e,t){const s=`.${t}`;let i=this.cssRules.get(s);i||(i=new Map,this.cssRules.set(s,i)),e.fontName!==figma.mixed&&(i.set("font-family",`'${e.fontName.family}', sans-serif`),e.fontName.style.toLowerCase().includes("bold")?i.set("font-weight","bold"):e.fontName.style.toLowerCase().includes("light")?i.set("font-weight","300"):e.fontName.style.toLowerCase().includes("medium")&&i.set("font-weight","500"),e.fontName.style.toLowerCase().includes("italic")&&i.set("font-style","italic")),e.fontSize!==figma.mixed&&i.set("font-size",this.convertToUnits(e.fontSize)),e.lineHeight!==figma.mixed&&"AUTO"!==e.lineHeight.unit&&("PIXELS"===e.lineHeight.unit?i.set("line-height",this.convertToUnits(e.lineHeight.value)):"PERCENT"===e.lineHeight.unit&&i.set("line-height",""+e.lineHeight.value/100)),e.letterSpacing!==figma.mixed&&i.set("letter-spacing",this.convertToUnits(e.letterSpacing.value));const n=e.textAlignHorizontal;"LEFT"===n?i.set("text-align","left"):"CENTER"===n?i.set("text-align","center"):"RIGHT"===n?i.set("text-align","right"):"JUSTIFIED"===n&&i.set("text-align","justify");const o=e.textDecoration;"UNDERLINE"===o?i.set("text-decoration","underline"):"STRIKETHROUGH"===o&&i.set("text-decoration","line-through");const r=e.textCase;if("UPPER"===r?i.set("text-transform","uppercase"):"LOWER"===r?i.set("text-transform","lowercase"):"TITLE"===r&&i.set("text-transform","capitalize"),e.fills&&Array.isArray(e.fills)&&e.fills.length>0){const t=e.fills.find((e=>"SOLID"===e.type&&!1!==e.visible));if(t&&"SOLID"===t.type){const e=this.rgbaToCSS(t.color.r,t.color.g,t.color.b,t.opacity||1);i.set("color",e)}}}generateClassName(e){return"layer-based"===this.config.classNamingStrategy&&e.name&&""!==e.name.trim()?this.sanitizeForCSS(e.name):`${e.type.toLowerCase()}-${++this.uniqueIdCounter}`}rgbaToCSS(e,t,s,i){const n=Math.round(255*e),o=Math.round(255*t),r=Math.round(255*s);return i<1?`rgba(${n}, ${o}, ${r}, ${i.toFixed(2)})`:`rgb(${n}, ${o}, ${r})`}linearGradientToCSS(e){return`linear-gradient(90deg, ${e.gradientStops.map((e=>`${this.rgbaToCSS(e.color.r,e.color.g,e.color.b,e.color.a)} ${Math.round(100*e.position)}%`)).join(", ")})`}radialGradientToCSS(e){return`radial-gradient(circle, ${e.gradientStops.map((e=>`${this.rgbaToCSS(e.color.r,e.color.g,e.color.b,e.color.a)} ${Math.round(100*e.position)}%`)).join(", ")})`}convertToUnits(e){switch(this.config.cssUnits){case"rem":return`${(e/16).toFixed(2)}rem`;case"em":return`${(e/16).toFixed(2)}em`;default:return`${Math.round(e)}px`}}sanitizeForCSS(e){const t=/^\d/.test(e);let s=e.toLowerCase().replace(/[^a-z0-9]/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")||"element";return t&&(s=this.getNameType(e)+"-"+s),s}getNameType(e){return/\$?\d+\.\d+/.test(e)?"price":/\d+(\.\d+)?\s*(lb|kg|g|oz)/.test(e)?"quantity":/\d+\s*items?/.test(e)?"count":"item"}escapeHtml(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}}})();