(()=>{"use strict";let e={cssUnits:"px",classNamingStrategy:"layer-based",attributeCasing:"kebab-case",layoutPreference:"flexbox",svgExportMode:"inline"};function t(e,t){return function(e){let t=0,s="",i=!1;for(let n=0;n<e.length;n++){const o=e[n];"<"===o&&"/"!==e[n+1]?(n>0&&(s+="\n"+"  ".repeat(t)),t++,i=!0):"<"===o&&"/"===e[n+1]?(t--,">"!==e[n-1]&&(s+="\n"+"  ".repeat(t)),i=!0):">"===o&&i&&(i=!1),s+=o}return s}(new i(t).processNodeForHtml(e).html)}function s(e,t){return new i(t).processNodeForCss(e).css.replace(/\{/g," {\n  ").replace(/;/g,";\n  ").replace(/\}/g,"\n}\n").replace(/\n  \n/g,"\n").trim()}figma.ui.onmessage=t=>{"update-config"===t.type&&(e=Object.assign(Object.assign({},e),t.config),figma.clientStorage.setAsync("plugin-config",e)),"get-config"===t.type&&figma.ui.postMessage({type:"config",config:e})},function(){var i,n,o,r;i=this,n=void 0,r=function*(){const i=yield figma.clientStorage.getAsync("plugin-config");i&&(e=Object.assign(Object.assign({},e),i)),figma.codegen.on("generate",(i=>{const{language:n,node:o}=i;if(!o)return[{language:"PLAINTEXT",code:"// No node selected",title:"Error"}];switch(n){case"HTML":return[{language:"HTML",code:t(o,e),title:"HTML"}];case"CSS":return[{language:"CSS",code:s(o,e),title:"CSS"}];default:return[{language:"PLAINTEXT",code:"// Language not supported: "+n,title:"Unsupported"}]}}))},new((o=void 0)||(o=Promise))((function(e,t){function s(e){try{c(r.next(e))}catch(e){t(e)}}function a(e){try{c(r.throw(e))}catch(e){t(e)}}function c(t){var i;t.done?e(t.value):(i=t.value,i instanceof o?i:new o((function(e){e(i)}))).then(s,a)}c((r=r.apply(i,n||[])).next())}))}();class i{constructor(e){this.uniqueIdCounter=0,this.config=e,this.cssRules=new Map}processNodeForHtml(e){if("visible"in e&&!e.visible)return{html:"",classNames:[]};const t=this.generateClassName(e),s=[t];let i="",n="div";switch(e.type){case"TEXT":n="p",i=this.escapeHtml(e.characters),this.processFontStyles(e,t);break;case"VECTOR":case"STAR":case"ELLIPSE":case"POLYGON":case"LINE":"inline"===this.config.svgExportMode&&(i="\x3c!-- SVG content would be exported here --\x3e",n="span");break;case"FRAME":case"GROUP":case"COMPONENT":case"COMPONENT_SET":case"INSTANCE":if(n="div","layoutMode"in e?this.processAutoLayout(e,t):this.processPosition(e,t),"children"in e){const t=[];for(const s of e.children){const e=this.processNodeForHtml(s);e.html&&t.push(e.html)}i=t.join("\n")}break;case"RECTANGLE":if(n="div","fills"in e&&e.fills&&Array.isArray(e.fills)){const t=e.fills.find((e=>"IMAGE"===e.type&&!1!==e.visible));t&&"IMAGE"===t.type&&(n="img",i="")}this.processBasicStyles(e,t);break;default:n="div",this.processBasicStyles(e,t)}let o="";const r=s.length>0?` class="${s.join(" ")}"`:"";return"img"===n?o=`<img${r} src="placeholder.jpg" alt="${e.name||"Image"}" />`:(o=`<${n}${r}>`,i&&(o+=i),o+=`</${n}>`),{html:o,classNames:s}}processNodeForCss(e){const{classNames:t}=this.processNodeForHtml(e);let s="";for(const[e,t]of this.cssRules.entries()){s+=`${e} {\n`;for(const[e,i]of t.entries())s+=`  ${e}: ${i};\n`;s+="}\n\n"}return{css:s,classNames:t}}processBasicStyles(e,t){const s=`.${t}`,i=new Map;if(this.cssRules.has(s)){const e=this.cssRules.get(s);if(e)for(const[t,s]of e.entries())i.set(t,s)}else this.cssRules.set(s,i);if("width"in e&&"height"in e&&(i.set("width",this.convertToUnits(e.width)),i.set("height",this.convertToUnits(e.height))),"cornerRadius"in e&&0!==e.cornerRadius&&e.cornerRadius!==figma.mixed){const t=e.cornerRadius;i.set("border-radius",this.convertToUnits(t))}"fills"in e&&e.fills&&Array.isArray(e.fills)&&this.processFills(e.fills,i),"strokes"in e&&e.strokes&&Array.isArray(e.strokes)&&this.processStrokes(e,i),"effects"in e&&e.effects&&Array.isArray(e.effects)&&this.processEffects(e.effects,i),this.cssRules.set(s,i)}processFills(e,t){const s=e.filter((e=>!1!==e.visible));if(0===s.length)return;if(1===s.length&&"SOLID"===s[0].type){const e=s[0],i=this.rgbaToCSS(e.color.r,e.color.g,e.color.b,e.opacity||1);return void t.set("background-color",i)}const i=s.filter((e=>"IMAGE"===e.type));if(i.length>0){t.set("background-image",'url("placeholder.jpg")');const e=i[0];return void("FILL"===e.scaleMode?t.set("background-size","cover"):"FIT"===e.scaleMode&&t.set("background-size","contain"))}const n=s.filter((e=>"GRADIENT_LINEAR"===e.type||"GRADIENT_RADIAL"===e.type||"GRADIENT_ANGULAR"===e.type));if(n.length>0){const e=n[0];if("GRADIENT_LINEAR"===e.type){const s=this.linearGradientToCSS(e);t.set("background-image",s)}else if("GRADIENT_RADIAL"===e.type){const s=this.radialGradientToCSS(e);t.set("background-image",s)}}}processStrokes(e,t){var s;if(!Array.isArray(e.strokes)||!e.strokes.length)return;const i=e.strokes.filter((e=>!1!==e.visible));if(0===i.length)return;const n=i[0];if("SOLID"===n.type){const i=this.rgbaToCSS(n.color.r,n.color.g,n.color.b,n.opacity||1),o=e.strokeWeight!==figma.mixed&&null!==(s=e.strokeWeight)&&void 0!==s?s:1;if(t.set("border-style","solid"),t.set("border-width",this.convertToUnits(o)),t.set("border-color",i),e.strokeAlign!==figma.mixed)switch(e.strokeAlign){case"INSIDE":t.set("box-sizing","border-box");break;case"OUTSIDE":t.set("outline",`${this.convertToUnits(o)} solid ${i}`),t.set("outline-offset",this.convertToUnits(o))}}}processEffects(e,t){const s=e.filter((e=>!1!==e.visible));if(0===s.length)return;const i=s.filter((e=>"DROP_SHADOW"===e.type||"INNER_SHADOW"===e.type));if(i.length>0){const e=i.map((e=>{const{color:t,offset:s,radius:i,spread:n,type:o}=e,r=this.rgbaToCSS(t.r,t.g,t.b,t.a);return`${this.convertToUnits(s.x)} ${this.convertToUnits(s.y)} ${this.convertToUnits(i)} ${this.convertToUnits(null!=n?n:0)} ${r}${"INNER_SHADOW"===o?" inset":""}`})).join(", ");t.set("box-shadow",e)}const n=s.filter((e=>"LAYER_BLUR"===e.type||"BACKGROUND_BLUR"===e.type));n.length>0&&n.forEach((e=>{"LAYER_BLUR"===e.type?t.set("filter",`blur(${this.convertToUnits(e.radius)})`):"BACKGROUND_BLUR"===e.type&&t.set("backdrop-filter",`blur(${this.convertToUnits(e.radius)})`)}))}processAutoLayout(e,t){const s=`.${t}`;let i=this.cssRules.get(s);i||(i=new Map,this.cssRules.set(s,i)),i.set("display","flex"),"HORIZONTAL"===e.layoutMode?i.set("flex-direction","row"):"VERTICAL"===e.layoutMode&&i.set("flex-direction","column"),"MIN"===e.primaryAxisAlignItems?i.set("justify-content","flex-start"):"CENTER"===e.primaryAxisAlignItems?i.set("justify-content","center"):"MAX"===e.primaryAxisAlignItems?i.set("justify-content","flex-end"):"SPACE_BETWEEN"===e.primaryAxisAlignItems&&i.set("justify-content","space-between"),"MIN"===e.counterAxisAlignItems?i.set("align-items","flex-start"):"CENTER"===e.counterAxisAlignItems?i.set("align-items","center"):"MAX"===e.counterAxisAlignItems&&i.set("align-items","flex-end"),0!==e.paddingLeft&&i.set("padding-left",this.convertToUnits(e.paddingLeft)),0!==e.paddingRight&&i.set("padding-right",this.convertToUnits(e.paddingRight)),0!==e.paddingTop&&i.set("padding-top",this.convertToUnits(e.paddingTop)),0!==e.paddingBottom&&i.set("padding-bottom",this.convertToUnits(e.paddingBottom)),0!==e.itemSpacing&&i.set("gap",this.convertToUnits(e.itemSpacing)),"WRAP"===e.layoutWrap&&i.set("flex-wrap","wrap")}processPosition(e,t){if(!("x"in e)||!("y"in e))return;const s=`.${t}`;let i=this.cssRules.get(s);i||(i=new Map,this.cssRules.set(s,i)),"allow-absolute"===this.config.layoutPreference&&(i.set("position","absolute"),i.set("left",this.convertToUnits(e.x)),i.set("top",this.convertToUnits(e.y)))}processFontStyles(e,t){const s=`.${t}`;let i=this.cssRules.get(s);i||(i=new Map,this.cssRules.set(s,i)),e.fontName!==figma.mixed&&(i.set("font-family",`'${e.fontName.family}', sans-serif`),e.fontName.style.toLowerCase().includes("bold")?i.set("font-weight","bold"):e.fontName.style.toLowerCase().includes("light")?i.set("font-weight","300"):e.fontName.style.toLowerCase().includes("medium")&&i.set("font-weight","500"),e.fontName.style.toLowerCase().includes("italic")&&i.set("font-style","italic")),e.fontSize!==figma.mixed&&i.set("font-size",this.convertToUnits(e.fontSize)),e.lineHeight!==figma.mixed&&"AUTO"!==e.lineHeight.unit&&("PIXELS"===e.lineHeight.unit?i.set("line-height",this.convertToUnits(e.lineHeight.value)):"PERCENT"===e.lineHeight.unit&&i.set("line-height",""+e.lineHeight.value/100)),e.letterSpacing!==figma.mixed&&i.set("letter-spacing",this.convertToUnits(e.letterSpacing.value));const n=e.textAlignHorizontal;"LEFT"===n?i.set("text-align","left"):"CENTER"===n?i.set("text-align","center"):"RIGHT"===n?i.set("text-align","right"):"JUSTIFIED"===n&&i.set("text-align","justify");const o=e.textDecoration;"UNDERLINE"===o?i.set("text-decoration","underline"):"STRIKETHROUGH"===o&&i.set("text-decoration","line-through");const r=e.textCase;"UPPER"===r?i.set("text-transform","uppercase"):"LOWER"===r?i.set("text-transform","lowercase"):"TITLE"===r&&i.set("text-transform","capitalize"),e.fills&&Array.isArray(e.fills)&&this.processFills(e.fills,i)}generateClassName(e){return"layer-based"===this.config.classNamingStrategy&&e.name&&""!==e.name.trim()?this.sanitizeForCSS(e.name):`${e.type.toLowerCase()}-${++this.uniqueIdCounter}`}rgbaToCSS(e,t,s,i){const n=Math.round(255*e),o=Math.round(255*t),r=Math.round(255*s);return i<1?`rgba(${n}, ${o}, ${r}, ${i.toFixed(2)})`:`rgb(${n}, ${o}, ${r})`}linearGradientToCSS(e){return`linear-gradient(90deg, ${e.gradientStops.map((e=>`${this.rgbaToCSS(e.color.r,e.color.g,e.color.b,e.color.a)} ${Math.round(100*e.position)}%`)).join(", ")})`}radialGradientToCSS(e){return`radial-gradient(circle, ${e.gradientStops.map((e=>`${this.rgbaToCSS(e.color.r,e.color.g,e.color.b,e.color.a)} ${Math.round(100*e.position)}%`)).join(", ")})`}convertToUnits(e){switch(this.config.cssUnits){case"rem":return`${(e/16).toFixed(2)}rem`;case"em":return`${(e/16).toFixed(2)}em`;default:return`${Math.round(e)}px`}}sanitizeForCSS(e){return e.toLowerCase().replace(/[^a-z0-9]/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")||"element"}escapeHtml(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}}})();