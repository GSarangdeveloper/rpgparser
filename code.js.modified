(()=>{"use strict";class e{isSceneNode(e){return e&&"object"==typeof e&&"type"in e}}class t extends e{constructor(){super(...arguments),this.colors={},this.typography={},this.spacing={}}extractDesignTokens(e){return this.colors={},this.typography={},this.spacing={},this.traverseNodeForTokens(e),{colors:this.colors,typography:this.typography,spacing:this.spacing}}traverseNodeForTokens(e){if(this.extractColorsFromNode(e),this.extractTypographyFromNode(e),this.extractSpacingFromNode(e),"children"in e&&Array.isArray(e.children))for(const t of e.children)this.isSceneNode(t)&&this.traverseNodeForTokens(t)}extractColorsFromNode(e){if("fills"in e&&e.fills&&Array.isArray(e.fills))for(const t of e.fills)if("SOLID"===t.type&&!1!==t.visible){const i=this.getColorTokenName(e,t),n=t,s=this.rgbToHex(n.color.r,n.color.g,n.color.b);this.colors[i]||(this.colors[i]={value:s,type:"color"})}if("strokes"in e&&e.strokes&&Array.isArray(e.strokes))for(const t of e.strokes)if("SOLID"===t.type&&!1!==t.visible){const i=this.getColorTokenName(e,t,"stroke"),n=t,s=this.rgbToHex(n.color.r,n.color.g,n.color.b);this.colors[i]||(this.colors[i]={value:s,type:"color"})}}extractTypographyFromNode(e){if("TEXT"===e.type){if(e.fontName===figma.mixed||e.fontSize===figma.mixed)return;const t=this.getTypographyTokenName(e),i={fontFamily:e.fontName.family,fontSize:`${e.fontSize}px`,fontWeight:this.getFontWeight(e.fontName.style)};e.lineHeight!==figma.mixed&&"AUTO"!==e.lineHeight.unit&&("PIXELS"===e.lineHeight.unit?i.lineHeight=`${e.lineHeight.value}px`:"PERCENT"===e.lineHeight.unit&&(i.lineHeight=(e.lineHeight.value/100).toString())),e.letterSpacing!==figma.mixed&&(i.letterSpacing=`${e.letterSpacing.value}px`),this.typography[t]||(this.typography[t]=i)}}extractSpacingFromNode(e){if("layoutMode"in e&&("HORIZONTAL"===e.layoutMode||"VERTICAL"===e.layoutMode)){if(e.itemSpacing>0){const t=`gap-${e.itemSpacing}`;this.spacing[t]||(this.spacing[t]={value:`${e.itemSpacing}px`,valueInRem:`${(e.itemSpacing/16).toFixed(2)}rem`})}if(e.paddingLeft>0||e.paddingRight>0||e.paddingTop>0||e.paddingBottom>0){const t=[{value:e.paddingLeft,name:"padding-left"},{value:e.paddingRight,name:"padding-right"},{value:e.paddingTop,name:"padding-top"},{value:e.paddingBottom,name:"padding-bottom"}];for(const e of t)if(e.value>0){const t=`${e.name}-${e.value}`;this.spacing[t]||(this.spacing[t]={value:`${e.value}px`,valueInRem:`${(e.value/16).toFixed(2)}rem`})}}}}getColorTokenName(e,t,i=""){let n="";if(n=e.name&&""!==e.name.trim()?e.name.toLowerCase().replace(/[^a-z0-9]/g,"-"):e.type.toLowerCase(),i&&(n=`${i}-${n}`),"SOLID"===t.type){const i=t,s=Math.round(255*i.color.r),o=Math.round(255*i.color.g),r=Math.round(255*i.color.b);"TEXT"===e.type?n="text-color":n.includes("background")||n.includes("bg")?n="background":n.includes("button")||n.includes("btn")?n="primary":s===o&&o===r&&(n=s<30?"black":s>240?"white":`gray-${s}`)}return n}getTypographyTokenName(e){let t="";if(e.fontSize===figma.mixed)return"text-style";const i=e.fontSize,n=e.name.toLowerCase();return t=n.includes("heading")||n.includes("title")?i>=32?"heading-1":i>=24?"heading-2":"heading-3":n.includes("body")||n.includes("paragraph")?"body":n.includes("label")||n.includes("caption")?"label":n.includes("button")?"button-text":i>=32?"heading-1":i>=24?"heading-2":i>=20?"heading-3":i>=16?"body":"caption",t}getFontWeight(e){const t=e.toLowerCase();return t.includes("thin")?100:t.includes("extra light")||t.includes("ultralight")?200:t.includes("light")?300:t.includes("regular")||t.includes("normal")?400:t.includes("medium")?500:t.includes("semi bold")||t.includes("semibold")?600:t.includes("bold")?700:t.includes("extra bold")||t.includes("extrabold")?800:t.includes("black")||t.includes("heavy")?900:400}rgbToHex(e,t,i){const n=Math.round(255*e),s=Math.round(255*t),o=Math.round(255*i);return`#${n.toString(16).padStart(2,"0")}${s.toString(16).padStart(2,"0")}${o.toString(16).padStart(2,"0")}`}}class i extends e{constructor(){super(...arguments),this.autoLayouts=[],this.breakpoints=[375,768,1024,1440]}extractLayoutInfo(e){return this.autoLayouts=[],this.traverseNodeForLayouts(e),{responsive:{breakpoints:this.breakpoints},autoLayout:this.autoLayouts}}traverseNodeForLayouts(e){if(!("layoutMode"in e)||"HORIZONTAL"!==e.layoutMode&&"VERTICAL"!==e.layoutMode||this.extractAutoLayoutFromNode(e),"children"in e&&Array.isArray(e.children))for(const t of e.children)this.isSceneNode(t)&&this.traverseNodeForLayouts(t)}extractAutoLayoutFromNode(e){if(!("layoutMode"in e))return;const t=e;if("NONE"===t.layoutMode)return;const i={display:"flex","flex-direction":"HORIZONTAL"===t.layoutMode?"row":"column"};t.itemSpacing>0&&(i.gap=`${t.itemSpacing}px`);const n=[];t.paddingTop>0&&n.push(`${t.paddingTop}px`),t.paddingRight>0&&n.push(`${t.paddingRight}px`),t.paddingBottom>0&&n.push(`${t.paddingBottom}px`),t.paddingLeft>0&&n.push(`${t.paddingLeft}px`),n.length>0&&(i.padding=n.join(" ")),"CENTER"===t.primaryAxisAlignItems?i["justify-content"]="center":"MAX"===t.primaryAxisAlignItems?i["justify-content"]="flex-end":"SPACE_BETWEEN"===t.primaryAxisAlignItems&&(i["justify-content"]="space-between"),"CENTER"===t.counterAxisAlignItems?i["align-items"]="center":"MAX"===t.counterAxisAlignItems&&(i["align-items"]="flex-end"),this.autoLayouts.push({direction:"HORIZONTAL"===t.layoutMode?"row":"column",gap:t.itemSpacing,cssProperties:i})}}class n extends e{constructor(){super(...arguments),this.components=[]}extractComponentInfo(e){return this.components=[],this.traverseNodeForComponents(e),{components:this.components}}traverseNodeForComponents(e){if("COMPONENT"===e.type?this.extractComponentFromNode(e):"COMPONENT_SET"===e.type&&this.extractComponentSetFromNode(e),"children"in e&&Array.isArray(e.children))for(const t of e.children)this.isSceneNode(t)&&this.traverseNodeForComponents(t)}extractComponentFromNode(e){const t=this.getComponentName(e);this.components.find((e=>e.name===t))||this.components.push({name:t,properties:[]})}extractComponentSetFromNode(e){const t=this.getComponentBaseName(e),i={};for(const t of e.children)if("COMPONENT"===t.type){if(!t.name.includes("="))continue;const e=t.name.split(",").map((e=>e.trim()));for(let t=1;t<e.length;t++){const n=e[t];if(n.includes("=")){const[e,t]=n.split("=").map((e=>e.trim()));i[e]||(i[e]=new Set),i[e].add(t)}}}const n={name:t,properties:Object.entries(i).map((([e,t])=>({name:e,options:Array.from(t)})))};this.components.push(n)}getComponentBaseName(e){return"COMPONENT_SET"===e.type?e.name:e.name.includes(",")?e.name.split(",")[0].trim():e.name}getComponentName(e){let t="";return e.name&&""!==e.name.trim()?(t=e.name.includes(",")?e.name.split(",")[0].trim():e.name.trim(),t=t.replace(/[^a-zA-Z0-9 ]/g,"").split(" ").map((e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase())).join("")):t="Component"+e.id.substring(0,4),t}}let s={cssUnits:"px",classNamingStrategy:"layer-based",attributeCasing:"kebab-case",layoutPreference:"flexbox",svgExportMode:"inline",extractDesignTokens:!0,extractLayoutInfo:!0,extractComponentInfo:!0};function o(e,i){const n=(new t).extractDesignTokens(e);return JSON.stringify(n,null,2)}function r(e,t){const n=(new i).extractLayoutInfo(e);return JSON.stringify(n,null,2)}function a(e,t){const i=(new n).extractComponentInfo(e);return JSON.stringify(i,null,2)}function c(e,s){const o=new g(s),r=o.processNodeForHtml(e),a=o.processNodeForCss(e),c=(new t).extractDesignTokens(e),l=(new i).extractLayoutInfo(e),d=(new n).extractComponentInfo(e),p={html:u(r.html),css:h(a.css),designTokens:c,layoutSpecifications:l,componentSpecifications:d};return JSON.stringify(p,null,2)}function l(e,t){return u(new g(t).processNodeForHtml(e).html)}function d(e,t){return h(new g(t).processNodeForCss(e).css)}function u(e){let t=0,i="",n=!1;for(let s=0;s<e.length;s++){const o=e[s];"<"===o&&"/"!==e[s+1]?(s>0&&(i+="\n"+"  ".repeat(t)),t++,n=!0):"<"===o&&"/"===e[s+1]?(t--,">"!==e[s-1]&&(i+="\n"+"  ".repeat(t)),n=!0):">"===o&&n&&(n=!1),i+=o}return i}function h(e){let t=e;return t=t.replace(/@media\s*\([^)]+\)\s*\{([^}]+)\}/g,((e,t)=>{const i=t.replace(/([^{]+)\{([^}]+)\}/g,((e,t,i)=>`  ${t.trim()} {\n${i.split(";").filter((e=>e.trim())).map((e=>`    ${e.trim()};`)).join("\n")}\n  }`));return`@media (${e.split("(")[1].split(")")[0]}) {\n${i}\n}`})),t=t.replace(/([^@].*?)\{/g,"$1 {\n  ").replace(/;(?![^{]*\})/g,";\n  ").replace(/\}(?!.*\n\s*@media)/g,"\n}\n").replace(/\n  \n/g,"\n").replace(/\s*\n\s*\n\s*\n/g,"\n\n").trim(),t}figma.ui.onmessage=e=>{"update-config"===e.type&&(s=Object.assign(Object.assign({},s),e.config),figma.clientStorage.setAsync("plugin-config",s)),"get-config"===e.type&&figma.ui.postMessage({type:"config",config:s})},function(){var e,t,i,n;e=this,t=void 0,n=function*(){const e=yield figma.clientStorage.getAsync("plugin-config");e&&(s=Object.assign(Object.assign({},s),e)),figma.codegen.on("generate",(e=>{const{language:t,node:i}=e;if(!i)return[{language:"PLAINTEXT",code:"// No node selected",title:"Error"}];switch(t){case"HTML":return[{language:"HTML",code:l(i,s),title:"HTML"}];case"CSS":return[{language:"CSS",code:d(i,s),title:"CSS"}];case"DESIGN_TOKENS":return[{language:"JSON",code:o(i),title:"Design Tokens"}];case"LAYOUT_INFO":return[{language:"JSON",code:r(i),title:"Layout Information"}];case"COMPONENT_INFO":return[{language:"JSON",code:a(i),title:"Component Information"}];case"AI_PACKAGE":return[{language:"JSON",code:c(i,s),title:"AI Design Package"}];default:return[{language:"PLAINTEXT",code:"// Language not supported: "+t,title:"Unsupported"}]}}))},new((i=void 0)||(i=Promise))((function(s,o){function r(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}c((n=n.apply(e,t||[])).next())}))}();class g{constructor(e){this.uniqueIdCounter=0,this.config=e,this.cssRules=new Map}processNodeForHtml(e){if("visible"in e&&!e.visible)return{html:"",classNames:[]};const t=this.generateClassName(e),i=[t];let n="",s="div",o={};const r=this.getSemanticClass(e);switch(r&&i.push(r),e.type){case"TEXT":s=this.determineTextTag(e),n=this.escapeHtml(e.characters),this.processFontStyles(e,t);break;case"VECTOR":case"STAR":case"ELLIPSE":case"POLYGON":case"LINE":"inline"===this.config.svgExportMode?(s="svg",o.width=String(Math.round(e.width)),o.height=String(Math.round(e.height)),o.viewBox=`0 0 ${Math.round(e.width)} ${Math.round(e.height)}`,o.fill="none",o.xmlns="http://www.w3.org/2000/svg",o["aria-hidden"]="true",n=this.generatePlaceholderSvg(e)):(s="img",o.src=`${this.sanitizeForCSS(e.name)}.svg`,o.alt="",o.width=String(Math.round(e.width)),o.height=String(Math.round(e.height)));break;case"FRAME":case"GROUP":case"COMPONENT":case"COMPONENT_SET":case"INSTANCE":if(s=this.determineContainerTag(e),"layoutMode"in e?this.processAutoLayout(e,t):this.processPosition(e,t),"children"in e){const t=[];for(const i of e.children){const e=this.processNodeForHtml(i);e.html&&t.push(e.html)}n=t.join("\n")}break;case"RECTANGLE":if(s=this.determineRectangleTag(e),"fills"in e&&e.fills&&Array.isArray(e.fills)){const t=e.fills.find((e=>"IMAGE"===e.type&&!1!==e.visible));if(t&&"IMAGE"===t.type){s="img";const i=this.sanitizeForCSS(e.name)||"image";if(o.src=`images/${i}.png`,o.alt=e.name||"Image",o.loading="lazy","width"in e&&"height"in e&&(o.width=String(Math.round(e.width)),o.height=String(Math.round(e.height))),"FILL"===t.scaleMode){const t=`.${this.sanitizeForCSS(e.name)}`;let i=this.cssRules.get(t);i||(i=new Map,this.cssRules.set(t,i)),i.set("object-fit","cover")}else if("FIT"===t.scaleMode){const t=`.${this.sanitizeForCSS(e.name)}`;let i=this.cssRules.get(t);i||(i=new Map,this.cssRules.set(t,i)),i.set("object-fit","contain")}else if("TILE"===t.scaleMode){s="div",delete o.src,delete o.alt,delete o.loading;const t=`.${this.sanitizeForCSS(e.name)}`;let n=this.cssRules.get(t);n||(n=new Map,this.cssRules.set(t,n)),n.set("background-image",`url("images/${i}.png")`),n.set("background-repeat","repeat"),n.set("width",this.convertToUnits(e.width)),n.set("height",this.convertToUnits(e.height))}}}this.processBasicStyles(e,t);break;default:s="div",this.processBasicStyles(e,t)}let a="";i.length>0&&(o.class=i.join(" "));const c=Object.entries(o).map((([e,t])=>`${e}="${t}"`)).join(" ");return"img"===s?a=`<img ${c} />`:(a=`<${s}${c?" "+c:""}>`,n&&(a+=n),a+=`</${s}>`),{html:a,classNames:i}}determineTextTag(e){const t=e.name.toLowerCase().includes("heading")||e.name.toLowerCase().includes("title")||e.name.toLowerCase().includes("h1")||e.name.toLowerCase().includes("h2"),i=e.fontSize!==figma.mixed&&e.fontSize>=20,n=e.fontName!==figma.mixed&&e.fontName.style.toLowerCase().includes("bold"),s=e.characters.length<30;return t&&i?e.fontSize!==figma.mixed&&e.fontSize>=32?"h1":e.fontSize!==figma.mixed&&e.fontSize>=24?"h2":"h3":s&&!n?"span":"p"}determineContainerTag(e){const t=e.name.toLowerCase();if(/^header$|^site-?header$/.test(t))return"header";if(/^footer$|^site-?footer$/.test(t))return"footer";if(/^main$|^main-?content$/.test(t))return"main";if(/^nav$|^navigation$|^navbar$/.test(t))return"nav";if(/^aside$|^sidebar$/.test(t))return"aside";if(/^article$/.test(t))return"article";if(/^section$/.test(t))return"section";if(t.includes("header"))return"header";if(t.includes("footer"))return"footer";if(t.includes("main")||t.includes("content"))return"main";if(t.includes("section")||t.includes("container"))return"section";if(t.includes("article")||t.includes("card"))return"article";if(t.includes("aside")||t.includes("sidebar"))return"aside";if(t.includes("nav")||t.includes("menu"))return"nav";if(t.includes("list")&&"children"in e&&e.children.length>0){if(e.children.some((e=>this.isSceneNode(e)&&e.name.toLowerCase().includes("item"))))return"ul"}else if(t.includes("form")||t.includes("contact"))return"form";return"div"}determineRectangleTag(e){const t=e.name.toLowerCase();return/^button$|^btn$|^btn-/.test(t)?"button":/^input-/.test(t)?"input":/^img$|^image$|^img-/.test(t)?"img":/^card$|^card-/.test(t)?"article":/^link$|^cta$/.test(t)?"a":t.includes("button")||t.includes("btn")?"button":t.includes("card")||t.includes("item")?"article":t.includes("input")||t.includes("field")?"input":t.includes("link")||t.includes("anchor")?"a":t.includes("image")||t.includes("pic")||t.includes("photo")?"img":"cornerRadius"in e&&e.cornerRadius!==figma.mixed&&e.cornerRadius>8?"width"in e&&e.width<200&&"height"in e&&e.height<80?"button":"article":"div"}getSemanticClass(e){const t=e.name.toLowerCase();return t.includes("button")||t.includes("btn")?"button":t.includes("card")?"card":t.includes("icon")?"icon":t.includes("input")?"input":t.includes("header")?"header":t.includes("footer")?"footer":t.includes("nav")?"nav":null}processNodeForCss(e){const{classNames:t}=this.processNodeForHtml(e),i=this.extractCssVariables();let n="";if(i.size>0){n+=":root {\n";for(const[e,t]of i.entries())n+=`  ${e}: ${t};\n`;n+="}\n\n"}n+="* {\n  box-sizing: border-box;\n  margin: 0;\n  padding: 0;\n}\n\n",n+=".container {\n  width: 100%;\n  max-width: 1200px;\n  margin: 0 auto;\n  padding: 0 15px;\n}\n\n",n+="/* Mobile First Media Queries */\n",n+="@media (min-width: 768px) {\n  /* Tablet styles */\n}\n\n",n+="@media (min-width: 992px) {\n  /* Desktop styles */\n}\n\n";for(const[e,t]of this.cssRules.entries()){n+=`${e} {\n`;for(const[e,i]of t.entries()){const t=this.formatPropertyName(e),s=this.getVariableNameForValue(e,i);n+=s?`  ${t}: var(${s});\n`:`  ${t}: ${i};\n`}n+="}\n\n"}return{css:n,classNames:t}}extractCssVariables(){const e=new Map,t=new Map;for(const[,e]of this.cssRules.entries())for(const[i,n]of e.entries())if(this.isVariableCandidateProperty(i)){const e=`${i}:${n}`,s=t.get(e)||{count:0,property:i};s.count++,t.set(e,s)}for(const[i,{count:n,property:s}]of t.entries())if(n>=2){const t=i.split(":")[1],n=this.createVariableName(s,t);e.set(n,t)}return e.has("--color-text")||e.set("--color-text","#333"),e.has("--color-bg")||e.set("--color-bg","#fff"),e.has("--font-main")||e.set("--font-main","'Inter', -apple-system, BlinkMacSystemFont, sans-serif"),e}isVariableCandidateProperty(e){return e.startsWith("color")||e.startsWith("background-color")||e.startsWith("font-")||"border-radius"===e||e.includes("shadow")}createVariableName(e,t){let i="--";return"color"===e||"background-color"===e?t.includes("rgb(0, 0, 0)")||t.includes("#000")?i+="color-black":t.includes("rgb(255, 255, 255)")||t.includes("#fff")?i+="color-white":i+="color"===e?"color-text":"color-primary":e.startsWith("font-")?i+=`font-${e.split("-")[1]}`:"border-radius"===e?i+="radius":e.includes("shadow")?i+="shadow":i+=e.replace(/([A-Z])/g,"-$1").toLowerCase(),i}getVariableNameForValue(e,t){return"color"===e&&t.includes("rgb(0, 0, 0)")?"--color-text":"background-color"===e&&t.includes("rgb(255, 255, 255)")?"--color-bg":"font-family"===e?"--font-main":null}formatPropertyName(e){return"camelCase"===this.config.attributeCasing?e.replace(/-([a-z])/g,((e,t)=>t.toUpperCase())):e}processBasicStyles(e,t){const i=`.${t}`,n=new Map;if(this.cssRules.has(i)){const e=this.cssRules.get(i);if(e)for(const[t,i]of e.entries())n.set(t,i)}else this.cssRules.set(i,n);if("width"in e&&"height"in e&&(n.set("width",this.convertToUnits(e.width)),n.set("height",this.convertToUnits(e.height))),"cornerRadius"in e&&0!==e.cornerRadius&&e.cornerRadius!==figma.mixed){const t=e.cornerRadius;n.set("border-radius",this.convertToUnits(t))}if("fills"in e&&e.fills&&Array.isArray(e.fills)){const t="TEXT"===e.type;this.processFills(e.fills,n,t,e)}"strokes"in e&&e.strokes&&Array.isArray(e.strokes)&&this.processStrokes(e,n),"effects"in e&&e.effects&&Array.isArray(e.effects)&&this.processEffects(e.effects,n),this.cssRules.set(i,n)}processFills(e,t,i=!1,n){const s=e.filter((e=>!1!==e.visible));if(0===s.length)return;if(1===s.length&&"SOLID"===s[0].type){const e=s[0],n=this.rgbaToCSS(e.color.r,e.color.g,e.color.b,e.opacity||1);return void(i?t.set("color",n):t.set("background-color",n))}const o=s.filter((e=>"IMAGE"===e.type));if(o.length>0&&!i){const e=n&&"name"in n&&this.sanitizeForCSS(n.name)||"background";t.set("background-image",`url("images/${e}.png")`);const i=o[0];"FILL"===i.scaleMode?(t.set("background-size","cover"),t.set("background-position","center")):"FIT"===i.scaleMode?(t.set("background-size","contain"),t.set("background-position","center"),t.set("background-repeat","no-repeat")):"TILE"===i.scaleMode?(t.set("background-size","auto"),t.set("background-repeat","repeat")):"CROP"===i.scaleMode&&(t.set("background-size","cover"),t.set("background-position","center"))}else if(!i){const e=s.filter((e=>"GRADIENT_LINEAR"===e.type||"GRADIENT_RADIAL"===e.type||"GRADIENT_ANGULAR"===e.type));if(e.length>0){const i=e[0];if("GRADIENT_LINEAR"===i.type){const e=this.linearGradientToCSS(i);t.set("background-image",e)}else if("GRADIENT_RADIAL"===i.type){const e=this.radialGradientToCSS(i);t.set("background-image",e)}}}}processStrokes(e,t){var i;if(!Array.isArray(e.strokes)||!e.strokes.length)return;const n=e.strokes.filter((e=>!1!==e.visible));if(0===n.length)return;const s=n[0];if("SOLID"===s.type){const n=this.rgbaToCSS(s.color.r,s.color.g,s.color.b,s.opacity||1),o=e.strokeWeight!==figma.mixed&&null!==(i=e.strokeWeight)&&void 0!==i?i:1;if(t.set("border-style","solid"),t.set("border-width",this.convertToUnits(o)),t.set("border-color",n),e.strokeAlign!==figma.mixed)switch(e.strokeAlign){case"INSIDE":t.set("box-sizing","border-box");break;case"OUTSIDE":t.set("outline",`${this.convertToUnits(o)} solid ${n}`),t.set("outline-offset",this.convertToUnits(o))}}}processEffects(e,t){const i=e.filter((e=>!1!==e.visible));if(0===i.length)return;const n=i.filter((e=>"DROP_SHADOW"===e.type||"INNER_SHADOW"===e.type));if(n.length>0){const e=n.map((e=>{const{color:t,offset:i,radius:n,spread:s,type:o}=e,r=this.rgbaToCSS(t.r,t.g,t.b,t.a);return`${this.convertToUnits(i.x)} ${this.convertToUnits(i.y)} ${this.convertToUnits(n)} ${this.convertToUnits(null!=s?s:0)} ${r}${"INNER_SHADOW"===o?" inset":""}`})).join(", ");t.set("box-shadow",e)}const s=i.filter((e=>"LAYER_BLUR"===e.type||"BACKGROUND_BLUR"===e.type));s.length>0&&s.forEach((e=>{"LAYER_BLUR"===e.type?t.set("filter",`blur(${this.convertToUnits(e.radius)})`):"BACKGROUND_BLUR"===e.type&&t.set("backdrop-filter",`blur(${this.convertToUnits(e.radius)})`)}))}processAutoLayout(e,t){const i=`.${t}`;let n=this.cssRules.get(i);n||(n=new Map,this.cssRules.set(i,n)),"grid"===this.config.layoutPreference&&this.isGridSuitable(e)?this.processGridLayout(e,n):this.processFlexboxLayout(e,n),0!==e.paddingLeft&&n.set("padding-left",this.convertToUnits(e.paddingLeft)),0!==e.paddingRight&&n.set("padding-right",this.convertToUnits(e.paddingRight)),0!==e.paddingTop&&n.set("padding-top",this.convertToUnits(e.paddingTop)),0!==e.paddingBottom&&n.set("padding-bottom",this.convertToUnits(e.paddingBottom))}processFlexboxLayout(e,t){t.set("display","flex"),"HORIZONTAL"===e.layoutMode?t.set("flex-direction","row"):"VERTICAL"===e.layoutMode&&t.set("flex-direction","column"),"MIN"===e.primaryAxisAlignItems?t.set("justify-content","flex-start"):"CENTER"===e.primaryAxisAlignItems?t.set("justify-content","center"):"MAX"===e.primaryAxisAlignItems?t.set("justify-content","flex-end"):"SPACE_BETWEEN"===e.primaryAxisAlignItems&&t.set("justify-content","space-between"),"MIN"===e.counterAxisAlignItems?t.set("align-items","flex-start"):"CENTER"===e.counterAxisAlignItems?t.set("align-items","center"):"MAX"===e.counterAxisAlignItems&&t.set("align-items","flex-end"),0!==e.itemSpacing&&t.set("gap",this.convertToUnits(e.itemSpacing)),"WRAP"===e.layoutWrap&&t.set("flex-wrap","wrap"),"children"in e&&e.children.length>0&&"WRAP"===e.layoutWrap&&this.processFlexChildren(e)}processGridLayout(e,t){t.set("display","grid"),"children"in e&&e.children.length>0&&("HORIZONTAL"===e.layoutMode?(this.calculateGridTemplateColumns(e,t),"SPACE_BETWEEN"===e.primaryAxisAlignItems?t.set("justify-content","space-between"):"CENTER"===e.primaryAxisAlignItems?t.set("justify-content","center"):"MAX"===e.primaryAxisAlignItems&&t.set("justify-content","end")):(this.calculateGridTemplateRows(e,t),"SPACE_BETWEEN"===e.primaryAxisAlignItems?t.set("align-content","space-between"):"CENTER"===e.primaryAxisAlignItems?t.set("align-content","center"):"MAX"===e.primaryAxisAlignItems&&t.set("align-content","end"))),0!==e.itemSpacing&&t.set("gap",this.convertToUnits(e.itemSpacing)),"WRAP"===e.layoutWrap&&t.set("grid-auto-flow","HORIZONTAL"===e.layoutMode?"row":"column")}calculateGridTemplateColumns(e,t){if(!("children"in e))return;if(this.areChildrenSameSize(e.children)){const i=Math.min(e.children.length,12);return void t.set("grid-template-columns",`repeat(${i}, 1fr)`)}const i=[];for(const t of e.children)"width"in t&&("layoutAlign"in t&&"STRETCH"===t.layoutAlign?i.push("1fr"):i.push(this.convertToUnits(t.width)));i.length>0&&t.set("grid-template-columns",i.join(" "))}calculateGridTemplateRows(e,t){if(!("children"in e))return;if(this.areChildrenSameSize(e.children)){const i=Math.min(e.children.length,12);return void t.set("grid-template-rows",`repeat(${i}, 1fr)`)}const i=[];for(const t of e.children)"height"in t&&("layoutAlign"in t&&"STRETCH"===t.layoutAlign?i.push("1fr"):i.push(this.convertToUnits(t.height)));i.length>0&&t.set("grid-template-rows",i.join(" "))}processFlexChildren(e){if("children"in e)for(let t=0;t<e.children.length;t++){const i=e.children[t];if(!this.isSceneNode(i)||"visible"in i&&!i.visible)continue;const n=`.${this.generateClassName(i)}`;let s=this.cssRules.get(n);if(s||(s=new Map,this.cssRules.set(n,s)),"layoutGrow"in i&&(1===i.layoutGrow?(s.set("flex-grow","1"),s.set("flex-shrink","1"),"HORIZONTAL"===e.layoutMode?s.set("width","100%"):s.set("height","100%")):(s.set("flex-grow","0"),s.set("flex-shrink","0"))),"WRAP"===e.layoutWrap){const t="@media (max-width: 768px)";let i=this.cssRules.get(t);i||(i=new Map,this.cssRules.set(t,i)),"HORIZONTAL"===e.layoutMode&&(i.set(`${n} width`,"100%"),i.set(`${n} flex-basis`,"100%"))}}}isSceneNode(e){return e&&"type"in e}isGridSuitable(e){if(!("children"in e)||0===e.children.length)return!1;if("WRAP"===e.layoutWrap)return!0;if(e.children.length>=4)return!0;let t=!1;for(const i of e.children)if("layoutAlign"in i&&"STRETCH"===i.layoutAlign){t=!0;break}return t}areChildrenSameSize(e){if(e.length<=1)return!0;let t=0,i=0;for(const n of e)if("width"in n&&"height"in n){t=n.width,i=n.height;break}for(const n of e)if("width"in n&&"height"in n){const e=Math.abs(n.width-t),s=Math.abs(n.height-i);if(e>.05*t||s>.05*i)return!1}return!0}processPosition(e,t){if(!("x"in e)||!("y"in e))return;const i=`.${t}`;let n=this.cssRules.get(i);n||(n=new Map,this.cssRules.set(i,n)),"allow-absolute"===this.config.layoutPreference&&(n.set("position","absolute"),n.set("left",this.convertToUnits(e.x)),n.set("top",this.convertToUnits(e.y)))}processFontStyles(e,t){const i=`.${t}`;let n=this.cssRules.get(i);n||(n=new Map,this.cssRules.set(i,n)),e.fontName!==figma.mixed&&(n.set("font-family",`'${e.fontName.family}', sans-serif`),e.fontName.style.toLowerCase().includes("bold")?n.set("font-weight","bold"):e.fontName.style.toLowerCase().includes("light")?n.set("font-weight","300"):e.fontName.style.toLowerCase().includes("medium")&&n.set("font-weight","500"),e.fontName.style.toLowerCase().includes("italic")&&n.set("font-style","italic")),e.fontSize!==figma.mixed&&n.set("font-size",this.convertToUnits(e.fontSize)),e.lineHeight!==figma.mixed&&"AUTO"!==e.lineHeight.unit&&("PIXELS"===e.lineHeight.unit?n.set("line-height",this.convertToUnits(e.lineHeight.value)):"PERCENT"===e.lineHeight.unit&&n.set("line-height",""+e.lineHeight.value/100)),e.letterSpacing!==figma.mixed&&n.set("letter-spacing",this.convertToUnits(e.letterSpacing.value));const s=e.textAlignHorizontal;"LEFT"===s?n.set("text-align","left"):"CENTER"===s?n.set("text-align","center"):"RIGHT"===s?n.set("text-align","right"):"JUSTIFIED"===s&&n.set("text-align","justify");const o=e.textDecoration;"UNDERLINE"===o?n.set("text-decoration","underline"):"STRIKETHROUGH"===o&&n.set("text-decoration","line-through");const r=e.textCase;if("UPPER"===r?n.set("text-transform","uppercase"):"LOWER"===r?n.set("text-transform","lowercase"):"TITLE"===r&&n.set("text-transform","capitalize"),e.fills&&Array.isArray(e.fills)&&e.fills.length>0){const t=e.fills.find((e=>"SOLID"===e.type&&!1!==e.visible));if(t&&"SOLID"===t.type){const e=this.rgbaToCSS(t.color.r,t.color.g,t.color.b,t.opacity||1);n.set("color",e)}}}generateClassName(e){if("layer-based"===this.config.classNamingStrategy){if(e.name&&""!==e.name.trim())return this.sanitizeForCSS(e.name)}else{if("bem"===this.config.classNamingStrategy)return this.generateBemClassName(e);if("unique-id"===this.config.classNamingStrategy)return`${e.type.toLowerCase()}-${"id"in e&&"string"==typeof e.id?e.id.substring(0,8):this.uniqueIdCounter.toString()}`}return`${e.type.toLowerCase()}-${++this.uniqueIdCounter}`}generateBemClassName(e){"COMPONENT"===e.type||e.type;const t=this.findParentNode(e);let i="",n="",s=[];switch(e.type){case"COMPONENT":case"COMPONENT_SET":i=this.sanitizeForCSS(e.name.split(",")[0].trim()),e.name.includes(",")&&e.name.split(",").slice(1).forEach((e=>{if(e.includes("=")){const[t,i]=e.split("=").map((e=>e.trim()));s.push(`${this.sanitizeForCSS(t)}-${this.sanitizeForCSS(i)}`)}}));break;case"INSTANCE":i=this.sanitizeForCSS(e.name.split(",")[0].trim()),e.name.includes(",")&&e.name.split(",").slice(1).forEach((e=>{if(e.includes("=")){const[t,i]=e.split("=").map((e=>e.trim()));s.push(`${this.sanitizeForCSS(t)}-${this.sanitizeForCSS(i)}`)}}));break;default:if(!t||"COMPONENT"!==t.type&&"INSTANCE"!==t.type&&"COMPONENT_SET"!==t.type)if(t&&"parent"in t){const t=this.findAncestorComponent(e);t?(i=this.sanitizeForCSS(t.name.split(",")[0].trim()),n=this.sanitizeForCSS(e.name)):i=this.sanitizeForCSS(e.name)}else i=this.sanitizeForCSS(e.name);else i=this.sanitizeForCSS(t.name.split(",")[0].trim()),n=this.sanitizeForCSS(e.name)}i||(i="block-"+ ++this.uniqueIdCounter);let o=i;return n&&(o+=`__${n}`),s.length,o}findParentNode(e){return null}findAncestorComponent(e){return null}rgbaToCSS(e,t,i,n){const s=Math.round(255*e),o=Math.round(255*t),r=Math.round(255*i);return n<1?`rgba(${s}, ${o}, ${r}, ${n.toFixed(2)})`:`rgb(${s}, ${o}, ${r})`}linearGradientToCSS(e){return`linear-gradient(90deg, ${e.gradientStops.map((e=>`${this.rgbaToCSS(e.color.r,e.color.g,e.color.b,e.color.a)} ${Math.round(100*e.position)}%`)).join(", ")})`}radialGradientToCSS(e){return`radial-gradient(circle, ${e.gradientStops.map((e=>`${this.rgbaToCSS(e.color.r,e.color.g,e.color.b,e.color.a)} ${Math.round(100*e.position)}%`)).join(", ")})`}convertToUnits(e){switch(this.config.cssUnits){case"rem":return`${(e/16).toFixed(2)}rem`;case"em":return`${(e/16).toFixed(2)}em`;default:return`${Math.round(e)}px`}}sanitizeForCSS(e){const t=/^\d/.test(e);let i=e.toLowerCase().replace(/[^a-z0-9]/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")||"element";return t&&(i=this.getNameType(e)+"-"+i),i}getNameType(e){return/\$?\d+\.\d+/.test(e)?"price":/\d+(\.\d+)?\s*(lb|kg|g|oz)/.test(e)?"quantity":/\d+\s*items?/.test(e)?"count":"item"}escapeHtml(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}generatePlaceholderSvg(e){const t=Math.round(e.width),i=Math.round(e.height),n=t/2,s=i/2;switch(e.type){case"VECTOR":return`<path d="M${.2*t},${.2*i} L${.8*t},${.2*i} L${.8*t},${.8*i} L${.2*t},${.8*i} Z" stroke="currentColor" stroke-width="2"/>`;case"STAR":const e=[],o=Math.min(t,i)/2*.9,r=o/2;for(let t=0;t<10;t++){const i=t%2==0?o:r,a=Math.PI/5*t,c=n+i*Math.sin(a),l=s-i*Math.cos(a);e.push(`${c},${l}`)}return`<polygon points="${e.join(" ")}" stroke="currentColor" stroke-width="2"/>`;case"ELLIPSE":return`<ellipse cx="${n}" cy="${s}" rx="${t/2*.9}" ry="${i/2*.9}" stroke="currentColor" stroke-width="2"/>`;case"POLYGON":const a=[],c=Math.min(t,i)/2*.9;for(let e=0;e<6;e++){const t=Math.PI/3*e,i=n+c*Math.sin(t),o=s-c*Math.cos(t);a.push(`${i},${o}`)}return`<polygon points="${a.join(" ")}" stroke="currentColor" stroke-width="2"/>`;case"LINE":return`<line x1="${.1*t}" y1="${.1*i}" x2="${.9*t}" y2="${.9*i}" stroke="currentColor" stroke-width="2"/>`;default:return`<rect x="${.1*t}" y="${.1*i}" width="${.8*t}" height="${.8*i}" stroke="currentColor" stroke-width="2"/>`}}}})();